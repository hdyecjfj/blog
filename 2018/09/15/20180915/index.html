<!DOCTYPE html><html lang="null"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>input框移动端中键盘收起改变页面布局出现空白的情况 | hdyecjtu</title><link rel="stylesheet" type="text/css" href="//fonts.neworld.org/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/blog/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/blog/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/blog/favicon.ico"><link rel="bookmark" href="/blog/favicon.ico"><link rel="apple-touch-icon" href="/blog/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/blog/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">input框移动端中键盘收起改变页面布局出现空白的情况</h1><a id="logo" href="/blog/.">hdyecjtu</a><p class="description"></p></div><div id="nav-menu"><a href="/blog/." class="current"><i class="fa fa-home"> Start</i></a><a href="/blog/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/blog/about/"><i class="fa fa-user"> Über</i></a><a href="/blog/atom.xml"><i class="fa fa-rss"> RSS</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">input框移动端中键盘收起改变页面布局出现空白的情况</h1><div class="post-meta"><a href="/blog/2018/09/15/20180915/#comments" class="comment-count"></a><p><span class="date">Sep 15, 2018</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>Schlägt</i></i></span></p></div><div class="post-content"><h2 id="解决position-fixed受虚拟键盘的影响"><a href="#解决position-fixed受虚拟键盘的影响" class="headerlink" title="解决position:fixed受虚拟键盘的影响"></a>解决position:fixed受虚拟键盘的影响</h2><ul>
<li><p>1、不适用fixed定位，使用替代方案（推荐的方法）：</p>
<ul>
<li><p>a方案：使用overflow-y:scroll;+position:absolute;</p>
</li>
<li><p>b方案：使用overflow-y:scroll;+flex布局;</p>
</li>
</ul>
</li>
</ul>
<p>其中，a方案内容区域的高度通过js控制；b方案内容区域的高度通过flex布局自动排版；</p>
<ul>
<li>2、根据输入框获取焦点与失去焦点事件切换fixed定位与static定位</li>
</ul>
<h2 id="问题源头可能是-移动端虚拟键盘出现的条件是：文本框（文本类）获得焦点"><a href="#问题源头可能是-移动端虚拟键盘出现的条件是：文本框（文本类）获得焦点" class="headerlink" title="问题源头可能是:移动端虚拟键盘出现的条件是：文本框（文本类）获得焦点"></a>问题源头可能是:移动端虚拟键盘出现的条件是：文本框（文本类）获得焦点</h2><p>弹出键盘后原先定位与底部的东西会被虚拟键盘顶上去，样式错乱！</p>
<p>首先我们会想到监听focus和blur事件，但是会有bug，虚拟键盘有自带的收起键盘，这样输入框还是聚焦事件，并没有触发blur事件。所以会导致失效的。</p>
<p>解决办法</p>
<p>我们可以换一个思路。监听改变浏览器窗口高度的时候去触发事件。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">windowInnerHeight = <span class="built_in">window</span>.innerHeight; <span class="comment">//获取当前浏览器窗口高度</span></span><br><span class="line">   $(<span class="built_in">window</span>).resize(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">if</span>(<span class="built_in">window</span>.innerHeight &lt; windowInnerHeight)&#123;</span><br><span class="line">           $(<span class="string">'.footer'</span>).removeClass(<span class="string">'footerss'</span>);</span><br><span class="line">       &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       $(<span class="string">'.footer'</span>).addClass(<span class="string">'footerss'</span>);</span><br><span class="line">       &#125;</span><br><span class="line">     &#125;);</span><br></pre></td></tr></table></figure></p>
<hr>
<h2 id="解决输入框input获取焦点得时，虚拟键盘会把fixed元素顶上去-次现在在部分安卓上能发现"><a href="#解决输入框input获取焦点得时，虚拟键盘会把fixed元素顶上去-次现在在部分安卓上能发现" class="headerlink" title="解决输入框input获取焦点得时，虚拟键盘会把fixed元素顶上去(次现在在部分安卓上能发现)"></a>解决输入框input获取焦点得时，虚拟键盘会把fixed元素顶上去(次现在在部分安卓上能发现)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="string">'#phone'</span>).bind(<span class="string">'focus'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$(<span class="string">'.bottom_fix'</span>).css(<span class="string">'position'</span>,<span class="string">'static'</span>);</span><br><span class="line">	<span class="comment">//或者$('#viewport').height($(window).height()+'px');</span></span><br><span class="line">&#125;).bind(<span class="string">'blur'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	$(<span class="string">'.bottom_fix'</span>).css(&#123;<span class="string">'position'</span>:<span class="string">'fixed'</span>,<span class="string">'bottom'</span>:<span class="string">'0'</span>&#125;);</span><br><span class="line">	<span class="comment">//或者$('#viewport').height('auto');</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="解决屏幕旋转也会出现以上问题"><a href="#解决屏幕旋转也会出现以上问题" class="headerlink" title="解决屏幕旋转也会出现以上问题"></a>解决屏幕旋转也会出现以上问题</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).bind(<span class="string">'orientationchange'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">window</span>.orientation==<span class="number">90</span> || <span class="built_in">window</span>.orientation==<span class="number">-90</span>)&#123;</span><br><span class="line">			$(<span class="string">'.bottom_fix'</span>).css(<span class="string">'position'</span>,<span class="string">'static'</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			$(<span class="string">'.bottom_fix'</span>).css(&#123;<span class="string">'position'</span>:<span class="string">'fixed'</span>,<span class="string">'bottom'</span>:<span class="string">'0'</span>&#125;);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>通过resize() 方法触发 resize 事件，或规定当发生 resize 事件时运行的函数。</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> windheight = $(<span class="built_in">window</span>).height();  <span class="comment">/*未唤起键盘时当前窗口高度*/</span></span><br><span class="line">        </span><br><span class="line">$(<span class="built_in">window</span>).resize(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> docheight = $(<span class="built_in">window</span>).height();  <span class="comment">/*唤起键盘时当前窗口高度*/</span>        </span><br><span class="line">   <span class="keyword">if</span>(docheight &lt; windheight)&#123;            <span class="comment">/*当唤起键盘高度小于未唤起键盘高度时执行*/</span></span><br><span class="line">      $(<span class="string">".submit"</span>).css(<span class="string">"position"</span>,<span class="string">"static"</span>);</span><br><span class="line">   &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      $(<span class="string">".submit"</span>).css(<span class="string">"position"</span>,<span class="string">"fixed"</span>);</span><br><span class="line">   &#125;           </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="h5-ios中软键盘弹起后-fixed定位失效"><a href="#h5-ios中软键盘弹起后-fixed定位失效" class="headerlink" title="h5 ios中软键盘弹起后 fixed定位失效"></a>h5 ios中软键盘弹起后 fixed定位失效</h2><p>position: fixed;在ios手机中会存在一个失效情况：<br>如果页面有输入框存在，点击输入框软键盘弹起后会发生一个现象: </p>
<ol>
<li>针对当前内容高度小于屏幕高度时：<br> 上下滑动页面时候，发现之前fixed定位在顶部的元素会跟随页面滚动，变成了absolute定位的效果。 </li>
<li>针对当前内容高度大于屏幕高度时：<br> 之前fixed定位在顶部的View不见了，下滑往上翻页面后，就会看那个fixed定位的元素错落在页面中，但并不是在最顶部。 </li>
</ol>
<p>综上可以看出，ios浏览器是针对fixed定位的元素作了处理，不再是之前定位效果，变成了absolute定位的效果但并不是absolute，但可以理解为top：对应为当前body的scrollTop值。 </p>
<blockquote>
<p>那么该怎么解决这个问题呢？</p>
</blockquote>
<p>在这里我是比较倾向于遵循ios浏览器处理fixed元素的初衷，浏览器去处理fixed元素应该是有它考虑的地方，退一步说其实也没有必要在这个情况下强制显示顶部元素，这时候用户的重点在于输入。 </p>
<p>这里给出的方案就是：在软键盘弹起后，直接把fixed的元素变成absolute的，不需要浏览器自己去做处理，待键盘收起后再恢复成fixed。 </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//以下代码环境是在React中</span></span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'focusin'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="comment">//软键盘弹出的事件处理</span></span><br><span class="line">    <span class="keyword">let</span> scrollTop = <span class="built_in">document</span>.body.scrollTop || <span class="built_in">document</span>.documentElement.scrollTop;</span><br><span class="line">    <span class="comment">//注只针对ios 、处在滚动中位置时</span></span><br><span class="line">    isIphone() &amp;&amp; scrollTop &gt; <span class="number">0</span> &amp;&amp; <span class="keyword">this</span>.setState(&#123; <span class="attr">className</span>: <span class="string">'postion-absolute'</span> &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">document</span>.body.addEventListener(<span class="string">'focusout'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="comment">//软键盘收起的事件处理</span></span><br><span class="line">     isIphone() &amp;&amp; <span class="keyword">this</span>.setState(&#123; <span class="attr">className</span>: <span class="string">''</span> &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h2 id="h5-安卓-键盘弹起界面适配-修改webview高度"><a href="#h5-安卓-键盘弹起界面适配-修改webview高度" class="headerlink" title="h5 安卓 键盘弹起界面适配 修改webview高度"></a>h5 安卓 键盘弹起界面适配 修改webview高度</h2><p>存在按钮使用绝对定位去实现。然后再到真机上去测试时，会发现ios手机是蛮正常的体验，软键盘会直接从底部覆盖最下面的按钮的，那是因为ios上的键盘是处在窗口的最上层，直接覆盖窗口不会挤压窗口；</p>
<p>首先还是从源头上看，针对安卓系统来说，软键盘弹起的方式是很有多种的常用的是这2种android:windowSoftInputMode=”adjustPan|adjustResize” </p>
<ol>
<li>“adjustResize”<br> 该Activity主窗口总是被调整屏幕的大小以便留出软键盘的空间，会调用onSizeChanged方法 </li>
<li>“adjustPan”<br> 该Activity主窗口并不调整屏幕的大小以便留出软键盘的空间。相反，当前窗口的内容将自动移动以便当前焦点 不被键盘覆盖和用户能总是看到输入内容的部分。不会调用onSizeChanged方法</li>
</ol>
<p>综上所述安卓会发生这个现象是因为原窗口为了留出软键盘的空间，高度发生了改变，绝对定位在底部的按钮就会被挤压，给人的假象就是被键盘顶起。既然我们知道了原因出在了原窗口高度发生了改变，那就有可做文章的地方，请看下面的代码：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取原窗口的高度</span></span><br><span class="line"><span class="keyword">var</span> originalHeight=<span class="built_in">document</span>.documentElement.clientHeight ||<span class="built_in">document</span>.body.clientHeight;</span><br><span class="line"><span class="built_in">window</span>.onresize=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//键盘弹起与隐藏都会引起窗口的高度发生变化</span></span><br><span class="line">    <span class="keyword">var</span>  resizeHeight=<span class="built_in">document</span>.documentElement.clientHeight || <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">     <span class="comment">//1. 从app自身的Webview高度方面去考虑</span></span><br><span class="line">        <span class="keyword">if</span>(resizeHeight<span class="number">-0</span>&lt;originalHeight<span class="number">-0</span>)&#123; <span class="comment">// resizeHeight&lt;originalHeight证明窗口被挤压了</span></span><br><span class="line">         plus.webview.currentWebview().setStyle(&#123;</span><br><span class="line">          height:originalHeight <span class="comment">//强设置为原高度</span></span><br><span class="line">         &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="comment">// 2. 从h5自身角度去解决</span></span><br><span class="line">    <span class="keyword">if</span>(resizeHeight<span class="number">-0</span>&lt;originalHeight<span class="number">-0</span>)&#123; <span class="comment">// resizeHeight&lt;originalHeight证明窗口被挤压了</span></span><br><span class="line">       可以去操作dom 进行隐藏按钮  <span class="comment">// xxx.style.display='none';</span></span><br><span class="line">       <span class="comment">//隐藏的手段就有很多了 可以z-index为负数、opacity透明度等等</span></span><br><span class="line">      &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       还原按钮的显示 <span class="comment">// xxx.style.display='';</span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="h5-移动端-监听软键盘弹起、收起"><a href="#h5-移动端-监听软键盘弹起、收起" class="headerlink" title="h5 移动端 监听软键盘弹起、收起"></a>h5 移动端 监听软键盘弹起、收起</h2><p>在adnroid中如何监听软键盘的弹起与收起，是利用的窗口的高度发生变化<br>window.onresize事件来做突破点的，但是ios中软键盘的弹起收起并不触发window.onresize事件。 </p>
<ul>
<li>总结： </li>
</ul>
<ol>
<li>在ios中软键盘弹起时，仅会引起$(‘body’).scrollTop值改变，但是我们可以通过输入框的获取焦点情况来做判断，但也只能在ios中采用这个方案，因为在android中存在主动收起键盘后，但输入框并没有失焦，而ios中键盘收起后就会失焦； </li>
<li>在android中软键盘弹起或收起时，会改变window的高度，因此监听window的onresize事件；</li>
</ol>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//一、Android</span></span><br><span class="line"><span class="comment">//获取原窗口的高度</span></span><br><span class="line"><span class="keyword">var</span> originalHeight=<span class="built_in">document</span>.documentElement.clientHeight ||<span class="built_in">document</span>.body.clientHeight;</span><br><span class="line"><span class="built_in">window</span>.onresize=<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//键盘弹起与隐藏都会引起窗口的高度发生变化</span></span><br><span class="line">       <span class="keyword">var</span> resizeHeight=<span class="built_in">document</span>.documentElement.clientHeight || <span class="built_in">document</span>.body.clientHeight;</span><br><span class="line">        <span class="keyword">if</span>(resizeHeight<span class="number">-0</span>&lt;originalHeight<span class="number">-0</span>)&#123;</span><br><span class="line">         <span class="comment">//当软键盘弹起，在此处操作</span></span><br><span class="line">         &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">         <span class="comment">//当软键盘收起，在此处操作</span></span><br><span class="line">         &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//二、ios</span></span><br><span class="line"><span class="comment">//focusin和focusout支持冒泡，对应focus和blur, 使用focusin和focusout的原因是focusin和focusout可以冒泡，focus和blur不会冒泡，这样就可以使用事件代理，处理多个输入框存在的情况。</span></span><br><span class="line"> <span class="built_in">document</span>.body.addEventListener(<span class="string">'focusin'</span>, () =&gt; &#123;</span><br><span class="line">            <span class="comment">//软键盘弹出的事件处理</span></span><br><span class="line">            <span class="keyword">if</span>(isIphone()）&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">  <span class="built_in">document</span>.body.addEventListener(<span class="string">'focusout'</span>, () =&gt; &#123;</span><br><span class="line">       <span class="comment">//软键盘收起的事件处理</span></span><br><span class="line">        <span class="keyword">if</span>(isIphone()）&#123;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">   &#125;)</span><br></pre></td></tr></table></figure>
<h2 id="使用fiexd定位input框可以被在ios系统中唤起键盘跟着推上去"><a href="#使用fiexd定位input框可以被在ios系统中唤起键盘跟着推上去" class="headerlink" title="使用fiexd定位input框可以被在ios系统中唤起键盘跟着推上去"></a>使用fiexd定位input框可以被在ios系统中唤起键盘跟着推上去</h2><p>当键盘出来的时候，红色的div不见了。然后我就查了一下，是ios里面的就有这个bug。我就试了很多网上的方法都是不行。发现只有ios这样，安卓没有。我就做了个兼容判断</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">//评论输入框</span><br><span class="line">        var interval</span><br><span class="line">        $(&quot;#shuruk&quot;).focus(function () &#123;</span><br><span class="line">            if (/iphone|ipad|ipod/.test(ua)) &#123;</span><br><span class="line">                interval = setInterval(function() &#123;</span><br><span class="line">                    document.body.scrollTop = document.body.scrollHeight</span><br><span class="line">                &#125;, 100)</span><br><span class="line">            &#125; else if (/android/.test(ua)) &#123;</span><br><span class="line"> </span><br><span class="line">            &#125;</span><br><span class="line"> </span><br><span class="line">        &#125;)</span><br><span class="line"> </span><br><span class="line">        //消息框失去焦点</span><br><span class="line">        $(&apos;#shuruk&apos;).blur(function()&#123;</span><br><span class="line">            clearInterval(interval);</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">mounted () &#123;</span><br><span class="line">   this.clientHeight = document.documentElement.clientHeight;</span><br><span class="line">   const that = this;</span><br><span class="line">   // 安卓手机键盘吊起挡住输入框</span><br><span class="line"></span><br><span class="line">   window.onresize = function() &#123;</span><br><span class="line"></span><br><span class="line">     if(document.documentElement.clientHeight &lt; that.clientHeight) &#123;</span><br><span class="line">       // scrollVal为负值</span><br><span class="line">       let scrollVal = document.documentElement.clientHeight-that.clientHeight;</span><br><span class="line">       $(&quot;.alert-main&quot;).css(&quot;marginTop&quot;,scrollVal);</span><br><span class="line">       $(&quot;.bottom-create&quot;).hide();</span><br><span class="line">     &#125;else &#123;</span><br><span class="line">       $(&quot;.alert-main&quot;).css(&quot;marginTop&quot;,0);</span><br><span class="line">       $(&quot;.bottom-create&quot;).show();</span><br><span class="line">     &#125;</span><br><span class="line">     </span><br><span class="line">   &#125;;</span><br><span class="line"> &#125;,</span><br></pre></td></tr></table></figure>
<p>今天这个bug 遇到了新问题，同样的华为手机上，当从别的路由吊起输入键盘的时候回到当前路由，</p>
<p>document.documentElement.clientHeight就变成了减去输入键盘高度的值，</p>
<p>这时需要在页面第一次加载将document.documentElement.clientHeight记录到store中，store中的值不会因为页面重新渲染而改变。</p>
</div><div class="tags"><a href="/blog/tags/小程序-vue/">小程序 vue</a></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/blog/2018/09/16/2018091501/" class="pre">关于错误码的汇总</a><a href="/blog/2018/09/07/20180907-1/" class="next">vue路由守卫+嵌套路由</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">Inhalte</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#解决position-fixed受虚拟键盘的影响"><span class="toc-text">解决position:fixed受虚拟键盘的影响</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#问题源头可能是-移动端虚拟键盘出现的条件是：文本框（文本类）获得焦点"><span class="toc-text">问题源头可能是:移动端虚拟键盘出现的条件是：文本框（文本类）获得焦点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解决输入框input获取焦点得时，虚拟键盘会把fixed元素顶上去-次现在在部分安卓上能发现"><span class="toc-text">解决输入框input获取焦点得时，虚拟键盘会把fixed元素顶上去(次现在在部分安卓上能发现)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#解决屏幕旋转也会出现以上问题"><span class="toc-text">解决屏幕旋转也会出现以上问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#h5-ios中软键盘弹起后-fixed定位失效"><span class="toc-text">h5 ios中软键盘弹起后 fixed定位失效</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#h5-安卓-键盘弹起界面适配-修改webview高度"><span class="toc-text">h5 安卓 键盘弹起界面适配 修改webview高度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#h5-移动端-监听软键盘弹起、收起"><span class="toc-text">h5 移动端 监听软键盘弹起、收起</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用fiexd定位input框可以被在ios系统中唤起键盘跟着推上去"><span class="toc-text">使用fiexd定位input框可以被在ios系统中唤起键盘跟着推上去</span></a></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/25/20180925/">SVG 边框 (stroke) 基本知识以及 SVG 边框动画</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/20/20180920-1/">零碎错误处理</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/20/20180920/">关于使用过的git命令</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/16/2018091501/">关于错误码的汇总</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/15/20180915/">input框移动端中键盘收起改变页面布局出现空白的情况</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/07/20180907-1/">vue路由守卫+嵌套路由</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/07/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/06/20180908/">JavaScript的函数支持重载吗？</a></li><li class="post-list-item"><a class="post-list-link" href="/blog/2018/09/06/20180907/">关于flex兼容问题</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-gui"> Kategorien</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/blog/categories/JS/">JS</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/blog/categories/vue/">vue</a><span class="category-list-count">2</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> Tags</i></div><div class="tagcloud"><a href="/blog/tags/vue/" style="font-size: 15px;">vue</a> <a href="/blog/tags/JS/" style="font-size: 15px;">JS</a> <a href="/blog/tags/css-svg/" style="font-size: 15px;">css svg</a> <a href="/blog/tags/VUE/" style="font-size: 15px;">VUE</a> <a href="/blog/tags/小程序-vue/" style="font-size: 15px;">小程序 vue</a> <a href="/blog/tags/git/" style="font-size: 15px;">git</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> Archiv</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/blog/archives/2018/09/">September 2018</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/blog/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/blog/atom.xml">RSS</a> |  <a href="/blog/about/">Über</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/blog/." rel="nofollow">danyang he.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/blog/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/blog/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script></body></html>